<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI í…ŒìŠ¤íŠ¸ - Omok-Lab</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #0a0e1a;
            color: #f9fafb;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: #6366f1;
            margin-bottom: 2rem;
        }

        .test-case {
            background: rgba(17, 24, 39, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .test-case h2 {
            color: #8b5cf6;
            margin-top: 0;
        }

        .board {
            display: inline-grid;
            grid-template-columns: repeat(5, 40px);
            gap: 2px;
            background: #d4a574;
            padding: 10px;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .cell {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: #c49563;
            border: 1px solid #8b6f47;
        }

        .result {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            font-weight: 600;
        }

        .result.pass {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid #10b981;
            color: #10b981;
        }

        .result.fail {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            color: #ef4444;
        }

        .result.pending {
            background: rgba(251, 191, 36, 0.2);
            border: 1px solid #fbbf24;
            color: #fbbf24;
        }

        button {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1rem;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
        }

        .details {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #d1d5db;
        }

        .summary {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid #6366f1;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .summary h2 {
            margin-top: 0;
            color: #6366f1;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #9ca3af;
        }
    </style>
</head>

<body>
    <h1>ğŸ§ª AI ëŒ€ê°ì„  ë°©ì–´ í…ŒìŠ¤íŠ¸</h1>

    <div class="summary" id="summary">
        <h2>í…ŒìŠ¤íŠ¸ ìš”ì•½</h2>
        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="totalTests">0</div>
                <div class="stat-label">ì´ í…ŒìŠ¤íŠ¸</div>
            </div>
            <div class="stat">
                <div class="stat-value" style="color: #10b981;" id="passedTests">0</div>
                <div class="stat-label">í†µê³¼</div>
            </div>
            <div class="stat">
                <div class="stat-value" style="color: #ef4444;" id="failedTests">0</div>
                <div class="stat-label">ì‹¤íŒ¨</div>
            </div>
        </div>
    </div>

    <button onclick="runAllTests()">ğŸš€ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>

    <div id="testResults"></div>

    <script src="game.js"></script>
    <script>
        const testCases = [
            {
                name: "í…ŒìŠ¤íŠ¸ 1: ëŒ€ê°ì„  3ëª© ë°©ì–´",
                description: "í‘ëŒì´ ëŒ€ê°ì„ ìœ¼ë¡œ 3ëª©ì„ ë§Œë“¤ì—ˆì„ ë•Œ AIê°€ ë°©ì–´í•´ì•¼ í•¨",
                setup: [
                    { row: 1, col: 1, stone: 1 }, // Black
                    { row: 2, col: 2, stone: 1 }, // Black
                    { row: 3, col: 3, stone: 1 }, // Black
                ],
                currentPlayer: 2, // White (AI)
                expectedPositions: [
                    { row: 0, col: 0 }, // ìœ„ìª½ ë°©ì–´
                    { row: 4, col: 4 }, // ì•„ë˜ìª½ ë°©ì–´
                ],
                boardSize: 5
            },
            {
                name: "í…ŒìŠ¤íŠ¸ 2: ëŒ€ê°ì„  4ëª© ê¸´ê¸‰ ë°©ì–´",
                description: "í‘ëŒì´ ëŒ€ê°ì„ ìœ¼ë¡œ 4ëª©ì„ ë§Œë“¤ì—ˆì„ ë•Œ AIê°€ ì¦‰ì‹œ ë°©ì–´í•´ì•¼ í•¨",
                setup: [
                    { row: 0, col: 0, stone: 1 }, // Black
                    { row: 1, col: 1, stone: 1 }, // Black
                    { row: 2, col: 2, stone: 1 }, // Black
                    { row: 3, col: 3, stone: 1 }, // Black
                ],
                currentPlayer: 2, // White (AI)
                expectedPositions: [
                    { row: 4, col: 4 }, // ìœ ì¼í•œ ë°©ì–´ ìœ„ì¹˜
                ],
                boardSize: 5,
                critical: true
            },
            {
                name: "í…ŒìŠ¤íŠ¸ 3: ì—­ëŒ€ê°ì„  ë°©ì–´",
                description: "í‘ëŒì´ ì—­ëŒ€ê°ì„ ìœ¼ë¡œ 3ëª©ì„ ë§Œë“¤ì—ˆì„ ë•Œ AIê°€ ë°©ì–´í•´ì•¼ í•¨",
                setup: [
                    { row: 0, col: 4, stone: 1 }, // Black
                    { row: 1, col: 3, stone: 1 }, // Black
                    { row: 2, col: 2, stone: 1 }, // Black
                ],
                currentPlayer: 2, // White (AI)
                expectedPositions: [
                    { row: 3, col: 1 }, // ì•„ë˜ ë°©ì–´
                    { row: 4, col: 0 }, // ë§¨ ì•„ë˜ ë°©ì–´
                ],
                boardSize: 5
            }
        ];

        function renderBoard(setup, boardSize = 5) {
            const grid = Array(boardSize).fill(null).map(() => Array(boardSize).fill(0));
            setup.forEach(({ row, col, stone }) => {
                grid[row][col] = stone;
            });

            let html = '<div class="board">';
            for (let row = 0; row < boardSize; row++) {
                for (let col = 0; col < boardSize; col++) {
                    const stone = grid[row][col];
                    let content = 'Â·';
                    if (stone === 1) content = 'âš«';
                    if (stone === 2) content = 'âšª';
                    html += `<div class="cell">${content}</div>`;
                }
            }
            html += '</div>';
            return html;
        }

        function runTest(testCase, index) {
            const board = new Board();

            // ì‘ì€ ë³´ë“œë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ì„ì‹œë¡œ í¬ê¸° ì¡°ì •
            const originalSize = BOARD_SIZE;

            // Setup board
            testCase.setup.forEach(({ row, col, stone }) => {
                board.grid[row][col] = stone;
                board.moveHistory.push({ row, col, stone, moveNumber: board.moveHistory.length + 1 });
            });
            board.currentPlayer = testCase.currentPlayer;

            // Run AI
            const ai = new MinimaxAI(board, 3); // Depth 3
            const startTime = Date.now();
            const bestMove = ai.getBestMove(testCase.currentPlayer);
            const calcTime = Date.now() - startTime;

            // Check result
            let passed = false;
            let resultMessage = '';

            if (bestMove) {
                const isExpected = testCase.expectedPositions.some(
                    pos => pos.row === bestMove.row && pos.col === bestMove.col
                );

                if (isExpected) {
                    passed = true;
                    resultMessage = `âœ… í†µê³¼! AIê°€ (${bestMove.row}, ${bestMove.col})ì— ë°©ì–´í–ˆìŠµë‹ˆë‹¤.`;
                } else {
                    resultMessage = `âŒ ì‹¤íŒ¨! AIê°€ (${bestMove.row}, ${bestMove.col})ì— ë†“ì•˜ìŠµë‹ˆë‹¤. ì˜ˆìƒ ìœ„ì¹˜: ${testCase.expectedPositions.map(p => `(${p.row}, ${p.col})`).join(' ë˜ëŠ” ')}`;
                }
            } else {
                resultMessage = 'âŒ ì‹¤íŒ¨! AIê°€ ìˆ˜ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';
            }

            return {
                passed,
                resultMessage,
                bestMove,
                calcTime,
                nodesEvaluated: ai.nodesEvaluated
            };
        }

        function runAllTests() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = '';

            let totalPassed = 0;
            let totalFailed = 0;

            testCases.forEach((testCase, index) => {
                const testDiv = document.createElement('div');
                testDiv.className = 'test-case';

                const result = runTest(testCase, index);

                testDiv.innerHTML = `
                    <h2>${testCase.name}</h2>
                    <p>${testCase.description}</p>
                    ${renderBoard(testCase.setup, testCase.boardSize)}
                    <div class="result ${result.passed ? 'pass' : 'fail'}">
                        ${result.resultMessage}
                    </div>
                    <div class="details">
                        <strong>ê³„ì‚° ì‹œê°„:</strong> ${result.calcTime}ms<br>
                        <strong>ë…¸ë“œ í‰ê°€ ìˆ˜:</strong> ${result.nodesEvaluated}<br>
                        ${result.bestMove ? `<strong>AI ì¶”ì²œ ìœ„ì¹˜:</strong> (${result.bestMove.row}, ${result.bestMove.col})<br><strong>ì ìˆ˜:</strong> ${result.bestMove.score}` : ''}
                    </div>
                `;

                resultsDiv.appendChild(testDiv);

                if (result.passed) totalPassed++;
                else totalFailed++;
            });

            // Update summary
            document.getElementById('totalTests').textContent = testCases.length;
            document.getElementById('passedTests').textContent = totalPassed;
            document.getElementById('failedTests').textContent = totalFailed;
        }

        // Auto-run tests on load
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(runAllTests, 500);
        });
    </script>
</body>

</html>